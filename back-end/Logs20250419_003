2025-04-19 13:19:59.342 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-04-19 13:19:59.378 +07:00 [INF] Applying migration '20250419061947_UpdatePageId'.
2025-04-19 13:19:59.412 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE "Pages" ALTER COLUMN "Id" TYPE uuid;
2025-04-19 13:21:43.398 +07:00 [INF] Registered 4 endpoints in 390 milliseconds.
2025-04-19 13:21:43.485 +07:00 [INF] User profile is available. Using 'C:\Users\admin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-19 13:21:43.739 +07:00 [INF] Now listening on: https://localhost:7050
2025-04-19 13:21:43.741 +07:00 [INF] Now listening on: http://localhost:5133
2025-04-19 13:21:43.831 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-19 13:21:43.833 +07:00 [INF] Hosting environment: Development
2025-04-19 13:21:43.834 +07:00 [INF] Content root path: D:\dev\myproject\a\back-end\back-end
2025-04-19 13:22:01.334 +07:00 [INF] Registered 4 endpoints in 291 milliseconds.
2025-04-19 13:22:01.402 +07:00 [INF] User profile is available. Using 'C:\Users\admin\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-19 13:22:01.567 +07:00 [INF] Now listening on: https://localhost:7050
2025-04-19 13:22:01.569 +07:00 [INF] Now listening on: http://localhost:5133
2025-04-19 13:22:01.633 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-19 13:22:01.634 +07:00 [INF] Hosting environment: Development
2025-04-19 13:22:01.636 +07:00 [INF] Content root path: D:\dev\myproject\a\back-end\back-end
2025-04-19 13:22:23.012 +07:00 [INF] CORS policy execution successful.
2025-04-19 13:22:23.028 +07:00 [INF] CORS policy execution successful.
2025-04-19 13:22:24.815 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'back_end.Data.ApplicationDbContext'.
System.InvalidOperationException: The primitive collection property 'Page.ChildrenId' is configured as required (non-nullable) but has a null value when saving changes. Either mark the property as optional (nullable) or set a non-null value.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.<PrepareToSave>g__CheckForNullCollection|113_1(IProperty property, <>c__DisplayClass113_0&)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
System.InvalidOperationException: The primitive collection property 'Page.ChildrenId' is configured as required (non-nullable) but has a null value when saving changes. Either mark the property as optional (nullable) or set a non-null value.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.<PrepareToSave>g__CheckForNullCollection|113_1(IProperty property, <>c__DisplayClass113_0&)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-04-19 13:22:24.821 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The primitive collection property 'Page.ChildrenId' is configured as required (non-nullable) but has a null value when saving changes. Either mark the property as optional (nullable) or set a non-null value.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.<PrepareToSave>g__CheckForNullCollection|113_1(IProperty property, <>c__DisplayClass113_0&)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.PrepareToSave()
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.GetEntriesToSave(Boolean cascadeChanges)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at back_end.Utilities.Service.UserService.CreateDefaultPage(ApplicationUser user) in D:\dev\myproject\a\back-end\back-end\Utilities\Service\UserService.cs:line 61
   at back_end.Utilities.Service.UserService.CreateUserAsync(String email, String username, String picture) in D:\dev\myproject\a\back-end\back-end\Utilities\Service\UserService.cs:line 34
   at back_end.Endpoints.GoogleAuth.GooglePostAuth.ExecuteAsync(AuthRequest req, CancellationToken ct) in D:\dev\myproject\a\back-end\back-end\Endpoints\GoogleAuth\GooglePostAuth.cs:line 50
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at FastEndpoints.Endpoint`2.ExecAsync(CancellationToken ct)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
